バックログプラグイン Ver.3.03】
http://hororo.wp.xdomain.jp/118/

2021/02/18更新 v506e対応版

-------------------------------------------------------------------------------------------------
■ 機能
-------------------------------------------------------------------------------------------------
  ・ログをCSSで自由に整形できます。
  ・キャラ名が無い時に、文頭に[font][ruby]等があると改行しない問題に対応しています。
  ・[r]で改行しない問題に対応しています。
  ・ルビをログに表示します。（CSSで非表示にはできます）
  ・同じキャラのセリフが続く場合、キャラ名が重複しないようにできます。
  ・デフォルトフォントスタイルをログに反映するかしないか選択可能です。
  ・[font]タグをログに反映するかしないか選択可能です。
  ・[glink]の選択をログに表示できます。※v2.01以降は gling タグで直指定も可能
  ・ログの縦書き対応。※v3.00以降は要パラメータ指定
  ・縦書き時の縦中横に対応。※v2.00以降
  ・ログのhtmlタグに、[chara_new] で定義した name値が class名として入ります。定義なしの場合は "name"。※2.01以降
  ・[chara_new]で指定した color をログに反映するか選択可能です。※v3.00以降
  ・[font]タグに name パラメータを追加。自由にclass名付けれます。※v3.00以降
  ・[mc_ruby][endruby]タグを追加、複数テキストにまとめてルビを振る事が出来ます。（エフェクト非対応）※v3.02
  ・[nowait]時、瞬間表示にできます。※v3.03
　
-------------------------------------------------------------------------------------------------
■ 使い方
-------------------------------------------------------------------------------------------------
  ①data/others/plugin に 「backlog」を入れてください。
　
  ②first.ks からプラグインを呼び出してください。
    [plugin name="backlog"]
　　
  ③backlog/backlog.css でデザインを変更する。

  ◆パラメーター（※デフォルトの場合は省略可）
      パラメータ名　 値　　　      省略時　　　説明
      def_style     true/false　　false　 　 デフォルトフォントスタイルをログに反映させる場合は true
      font_style　　true/false　　false      [font]をログにログに反映させる場合は true
      name_repeat　 true/false　　true       同じキャラのセリフが続く場合、毎行キャラ名を入れる場合は true
      name_none　　 true/false　　false      ログにキャラ名を入れない場合は true
      name_color    truefalse    false      [chara_new]タグで指定した色をバックログに反映させる場合は "true"
      glink_log　　 true/false　　false      [glink]の選択をログに表示。
      glink_name  　文字列　　　　≪選択!≫　 [glink]の名前部分
      mark        　文字列　　　　 ：         名前とテキストの間の記号※glinkには付きません
      vertical    　true/false　　false      バックログを縦書きにする場合は true
      nowait        mp.nowait    false      nowaitを瞬間表示にする場合は true
　　
  ◆記述例
    例1：キャラ名重複なし、[glink]ログ反映。
      [plugin name="backlog" name_repeat="true" glink_log="true"]

    例2：[font]反映、[glink]ログ反映＋ログタイトルを「Select」に。
      [plugin name="backlog" font_style="true" glink_log="true" glink_name="Select"]

  ◆ [glink]
    [glink (略) log=true] or [glink (略) log=false] でログの on/off 切り替えができます。

    ※[plugin] の glink_log よりも、[glink] の log が優先されます。
    例えば、[plugin glink_log=true]でonにしても、[glink log=false] で個別offが可能です。

  ◆ 縦中横について
    ・メッセージ
      [font] のパラメータとして name=tcy を指定する。
      例：[font size="30"]ちょっとまったーーー[resetfont][font size="30" name=tcy]!![resetfont]
    ・glink・ptext
      テキストの縦中横にしたい部分を <span></span> で囲い、name=text_tcy を指定します。
      例：[ptext text="テキストテキスト<span>!?</span>" vertical=true name=text_tcy]
        　[glink text="興味あります<span>!!</span>" name="vertical,text_tcy"]
-------------------------------------------------------------------------------------------------
■ ログのhtmlコード
-------------------------------------------------------------------------------------------------
  ◆通常ログ
    <dl class="log">
      <dt class="log_name akane"><span class="chara_name">あかね</span><span class="mark">：</span></dt>
      <dd class="log_text akane"><span class="text">テキスト</span></dd>
    </dl>

    ※chara_new の name値が無い場合
    <dl class="log">
      <dt class="log_name no_name"><span class="chara_name">?</span><span class="mark">：</span></dt>
      <dd class="log_text no_name"><span class="text">テキスト</span></dd>
    </dl>

  ◆通常ログ（name_repeat=true時）
    <dl class="log">
      <dt class="log_name akane"><span class="chara_name">あかね</span><span class="mark">：</span></dt>
      <dd class="log_text akane"><span class="text">テキスト1行目</span></dd>
    </dl>
    <dl class="log none">
      <dt class="log_name akane none"><span class="chara_name">あかね</span><span class="mark">：</span></dt>
      <dd class="log_text akane"><span class="text">テキスト2行目</span></dd>
    </dl>

  ◆通常ログ（name_none=true時）
    <dl class="log">
      <dt class="name_none"></dt>
      <dd class="log_text no_name"><span class="text">テキスト</span></dd>
    </dl>

  ◆glinkログ
    <dl class="log glink">
      <dt class="log_name glink">≪選択肢≫</dt>
      <dd class="log_text glink">テキスト</dd>
    </dl>

-------------------------------------------------------------------------------------------------
■ [mc_ruby] タグの使い方と注意点
-------------------------------------------------------------------------------------------------
  複数の文字にルビを振る事ができます。[mc_ruby][endruby]で囲います。

  ◆記述例
    [mc_ruby text=るび]ルビ[endruby]

  ◆注意点
    ルビ自体にはエフェクトがかからないので、エフェクト使用は非推奨。
    公式の[ruby]はそのまま使えます。

-------------------------------------------------------------------------------------------------
■ 動作確認
-------------------------------------------------------------------------------------------------
  ティラノスクリプトv506e

-------------------------------------------------------------------------------------------------
■ 注意点
-------------------------------------------------------------------------------------------------
  スクリプトのエンジン本体を改造しています。
  同じ関数を変更しているプラグインとの併用はできません。
  他verのティラノスクリプトでは動作しない可能性があります。
　
-------------------------------------------------------------------------------------------------
■ 改造項目  ※下記関数を改造しているプラグインとは併用できません。
-------------------------------------------------------------------------------------------------
  ・kag.tag.js
      ・r
      ・p
      ・er
      ・cm
      ・ct
      ・font
      ・resetfont
      ・glink
      ・text.showMessage
      ・l *nowaitのみ
      ・s *nowaitのみ

  ・kag.menu.js
      ・displayLog

-------------------------------------------------------------------------------------------------
■ 免責
-------------------------------------------------------------------------------------------------
  このプラグインを使用したことにより生じた損害・損失に対して制作者は一切責任を負いません。

-------------------------------------------------------------------------------------------------
■ 利用規約
-------------------------------------------------------------------------------------------------
  ・改造・再配布は自由です。ただし、有償での再配布は禁止します。
    改造後データの配布も同様にお願いします。
  ・利用報告・クレジット表記は任意です。
  ・このプラグインはドネーションウェア（カンパウェア）です。
    もしよろしければ寄付をお願いいたします。（強制ではありません）

-------------------------------------------------------------------------------------------------
■ 制作者
-------------------------------------------------------------------------------------------------
  name　　hororo
  site　　めも調　http://hororo.wp.xdomain.jp/
  mail　　ruru.amu@gmail.com
  twitter @hororo_memocho

-------------------------------------------------------------------------------------------------
■ ご協力ありがとうございます
-------------------------------------------------------------------------------------------------
  SOroom SOrow 様　http://north.undo.jp/
	にせ十字 様  https://github.com/falsecross
　
-------------------------------------------------------------------------------------------------
■ 更新履歴
-------------------------------------------------------------------------------------------------
  2021/02/11  ver3.03  [nowait]瞬間表示対応テスト版。[font]タグ等がセーブタイトルにも反映されてしまう不具合を修正。
  2021/02/11  ver3.02  [mc_ruby][endruby]タグを追加。TIPプラグインv4.03との併用対応。v506eにて動作確認。
  2020/09/21　ver3.01  TIPプラグインV4.00との併用対応。
  2020/09/03　ver3.00  設計変更。v504aにて動作確認。
  2018/10/12　ver2.05  name_none=false で、[l]時にログがインデントされる不具合修正。v472dにて動作確認。
  2018/03/24　ver2.04  [l]時にセーブタイトルが正しく取得出来ない不具合修正。v470_rc6bにて動作確認。
  2017/10/24　ver2.03  ティラノv457g対応。グリフ表示方法変更に対応。
  2017/08/20　ver2.02  セーブにメッセージが入らない件を修正。v456dにて動作確認。
  2017/07/26　ver2.01a console.log削除し忘れ修正…。
  2017/07/19　ver2.01  glink のログ表示を個別対応可能に、chara_name を class 指定するよう変更。
                       ログHTMLの不要（？）なclass指定を削除。
  2017/07/03　ver2.00a console.log削除し忘れ修正。init.ks整理。
  2017/07/02　ver2.00　ティラノv455対応。
  2016/08/10　ver1.00　公開
